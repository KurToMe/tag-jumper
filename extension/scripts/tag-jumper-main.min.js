var DomParser,ElementActor,ElementArticulator,GameUi,tjump,__bind=function(t,e){return function(){return t.apply(e,arguments)}};tjump={},tjump.overlay=document.createElement("div"),tjump.overlay.id="main-overlay",tjump.overlay.className+="overlay",tjump.canvas=document.createElement("canvas"),tjump.canvas.id="main-canvas",tjump.canvas.className+="canvas",tjump.overlay.appendChild(tjump.canvas),tjump.ctx=tjump.canvas.getContext("2d"),tjump.$document=$(document),document.body.appendChild(tjump.overlay),tjump.SCALE=32,tjump.FRAME_RATE=1/60,tjump.VELOCITY_ITERATIONS=10,tjump.POSITION_ITERATIONS=10,tjump.GRAVITY=new Box2D.Common.Math.b2Vec2(0,0),tjump.getWidth=function(){return tjump.canvas.offsetWidth},tjump.getHeight=function(){return tjump.canvas.offsetHeight},tjump.scaleToPhys=function(t){return t/tjump.SCALE},tjump.scaleVecToPhys=function(t){return t.Multiply(1/tjump.SCALE),t},tjump.scaleToScreen=function(t){return t*tjump.SCALE},tjump.applyXForce=function(t,e){var n,i,o;return n=Box2D.Common.Math.b2Vec2,i=t.GetPosition(),o=new n(e,0),t.ApplyForce(o,i)},tjump.applyYForce=function(t,e){var n,i,o;return n=Box2D.Common.Math.b2Vec2,i=t.GetPosition(),o=new n(0,e),t.ApplyForce(o,i)},tjump.isBodyInContact=function(t,e){var n,i;return n=t.GetFixtureA().GetBody(),i=t.GetFixtureB().GetBody(),n===e||i===e?!0:!1},ElementActor=function(){function t(t,e){this.element=t,this.actor=e,this.update=__bind(this.update,this),this.isVisible=__bind(this.isVisible,this),this.getLocation=__bind(this.getLocation,this),this.$element=$(t)}return t.prototype.getLocation=function(){var t;return t={top:this.$element.offset().top-tjump.$document.scrollTop(),left:this.$element.offset().left-tjump.$document.scrollLeft()}},t.prototype.isVisible=function(){return this.$element.is(":visible")},t.prototype.update=function(){var t;return this.isVisible()?(t=this.getLocation(),this.actor.setVisible(!0),this.actor.setLocation(t.left,t.top)):this.actor.setVisible(!1)},t}(),GameUi=function(){function t(t,e,n){this.createTextActor=__bind(this.createTextActor,this),this.createRectActorWithBody=__bind(this.createRectActorWithBody,this),this.bodyFromActor=__bind(this.bodyFromActor,this);var i,o;o=t.offsetWidth,i=t.offsetHeight,this.director=(new CAAT.Director).initialize(o,i,t),this.scene=this.director.createScene(),CAAT.PMR=tjump.SCALE,CAAT.enableBox2DDebug(!0,this.director,e),this.scene.onRenderStart=n,CAAT.loop(tjump.FRAME_RATE)}return t.prototype.bodyFromActor=function(t,e){return CAAT.B2DPolygonBody.createPolygonBody(e,{x:t.x,y:t.y,bodyType:Box2D.Dynamics.b2Body.b2_staticBody,density:1,restitution:1,friction:1,image:null,polygonType:CAAT.B2DPolygonBody.Type.BOX,bodyDef:[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y+t.height}],bodyDefScale:1,bodyDefScaleTolerance:0,userData:{}})},t.prototype.createRectActorWithBody=function(t){var e;return e=(new CAAT.Actor).setLocation(t.left,t.top).setSize(t.width,t.height).setFillStyle("orange").setAlpha(.6),this.scene.addChild(e),e},t.prototype.createTextActor=function(t){var e;return e=(new CAAT.TextActor).setLocation(t.left,t.top).setText(t.htmlId).setFillStyle("black"),this.scene.addChild(e)},t}(),ElementArticulator=function(){function t(){this.isValid=__bind(this.isValid,this),this.articulateElement=__bind(this.articulateElement,this)}return t.prototype.articulateElement=function(t){return this.isValid(t)?.9>Math.random()?!1:(tjump.createPlatform(t),!0):!1},t.prototype.isValid=function(t){return t.offsetWidth?t.offsetWidth>tjump.canvas.offsetWidth/2?!1:t.offsetHeight>tjump.canvas.offsetHeight/2?!1:5>t.offsetWidth?!1:5>t.offsetHeight?!1:!0:!1},t}(),DomParser=function(){function t(t){this.articulator=t,this.parseElement=__bind(this.parseElement,this),this.parsePage=__bind(this.parsePage,this)}return t.prototype.parsePage=function(){return this.elementCount=0,this.parseElement(document.body)},t.prototype.parseElement=function(t){var e,n,i,o,r,s;if(n=this.articulator.articulateElement(t),this.elementCount++,!(this.elementCount>3e4)){for(r=t.childNodes,s=[],i=0,o=r.length;o>i;i++)e=r[i],s.push(this.parseElement(e));return s}},t}(),tjump.createPlatform=function(t){var e,n,i;return i={top:t.offsetTop,left:t.offsetLeft,width:t.offsetWidth,height:t.offsetHeight,htmlId:t.id},e=tjump.ui.createRectActorWithBody(i,tjump.world),n=tjump.ui.bodyFromActor(e,tjump.world),tjump.updatables.push(new ElementActor(t,e))},tjump.beginContact=function(){},tjump.update=function(){var t,e,n,i,o;for(tjump.world.Step(tjump.FRAME_RATE,tjump.VELOCITY_ITERATIONS,tjump.POSITION_ITERATIONS),tjump.world.ClearForces(),i=tjump.updatables,o=[],e=0,n=i.length;n>e;e++)t=i[e],o.push(t.update());return o},tjump.init=function(){var t,e,n;return tjump.updatables=[],e=Box2D.Dynamics.b2DebugDraw,t=!0,tjump.world=new Box2D.Dynamics.b2World(tjump.GRAVITY,t),tjump.elementArticulator=new ElementArticulator,tjump.domParser=new DomParser(tjump.elementArticulator),tjump.ui=new GameUi(tjump.canvas,tjump.world,tjump.update),tjump.domParser.parsePage(),n=new Box2D.Dynamics.b2ContactListener,n.BeginContact=tjump.beginContact,tjump.world.SetContactListener(n)},tjump.init();